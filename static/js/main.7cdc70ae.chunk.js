(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{177:function(e,t,n){},200:function(e,t,n){},205:function(e,t,n){"use strict";n.r(t);var a,r,c,i=n(1),s=n.n(i),o=n(64),l=n.n(o),u=(n(177),n(5)),d=n(4),p=n(6),b=n.n(p),j=n(16),f=n(14),h=n(3),v=n(10),x=n(27),O=n.n(x),m=(n(199),n(200),n(213)),g=n(214),y=n(0);function k(e){return Object(y.jsxs)("div",{style:{display:e.show?"block":"none"},children:[" ",e.children," "]})}function F(e){return Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(y.jsxs)("label",{children:[" ",e.label," "]}),Object(y.jsx)(w,{enabled:e.enabled,setEnabled:e.setEnabled})]})}function w(e){var t=v.a.input(a||(a=Object(f.a)(["\n        opacity: 0;\n        width: 0;\n        height: 0;\n    "]))),n=v.a.label(r||(r=Object(f.a)(["\n        position: relative;\n        display: inline-block;\n        width: 30px;\n        height: 18px;\n\n    "]))),i=v.a.span(c||(c=Object(f.a)(["\n        position: absolute;\n        cursor: pointer;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: ",';\n        transition: .4s;\n        border-radius: 18px;\n\n        &:before {\n            position: absolute;\n            content: "";\n            height: 14px;\n            width: 14px;\n            left: 4px;\n            bottom: 2px;\n            background-color: white;\n            transition: .4s;\n            border-radius: 50%;\n            transform: ',";\n        }\n    "])),(function(e){return e.left?"#cccccc":"#2196F3"}),(function(e){return e.left?"translateX(0px)":"translateX(8px)"}));return i.defaultProps={left:!1},Object(y.jsxs)(n,{className:"switch",children:[Object(y.jsx)(t,{type:"checkbox",checked:e.enabled,onClick:function(){return e.setEnabled(!e.enabled)}}),Object(y.jsx)(i,{left:!e.enabled})]})}function S(e){return Object(y.jsx)("hr",{style:{border:"0px",height:"1px",backgroundImage:"linear-gradient(to right, #CCCCCC66, #CCCCCCFF, #CCCCCC66)"}})}function E(e){var t=Object(i.useState)(Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)),n=Object(h.a)(t,1)[0],a=s.a.Children.map(e.children,(function(t){return s.a.isValidElement(t)?s.a.cloneElement(t,{group:n,checked:t.props.value===e.value,setter:e.setter}):t}));return Object(y.jsxs)("div",{style:{flexFlow:"column",display:"flex"},children:[" ",a," "]})}function C(e){var t,n,a=e.group+"-"+e.value,r=null!==(t=e.setter)&&void 0!==t?t:function(e){};return Object(y.jsxs)("div",{children:[Object(y.jsx)("input",{type:"radio",id:a,value:e.value,name:e.group,checked:null!==(n=e.checked)&&void 0!==n&&n,onChange:function(){return r(e.value)}}),Object(y.jsxs)("label",{htmlFor:a,children:[" ",e.value," "]})]})}function M(e){var t=Object(i.useState)(!1),n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(y.jsxs)("div",{children:[Object(y.jsxs)("h2",{style:{cursor:"pointer"},onClick:function(){return r(!a)},children:[a?Object(y.jsx)(m.a,{}):Object(y.jsx)(g.a,{})," ",e.title]}),Object(y.jsx)("div",{style:{margin:"10px"},children:a?Object(y.jsx)("div",{children:e.children}):Object(y.jsx)("div",{style:{display:"none"},children:e.children})})]})}var T,D,A=n(9);function I(e){var t=v.a.p(T||(T=Object(f.a)(["\n    margin-bottom: 0px;\n    margin-top: 2px;\n  "])));return Object(y.jsxs)("div",{style:{position:"absolute",right:"0px",bottom:"0px"},className:"card",children:[Object(y.jsx)("h3",{children:" Trip Summary "}),Object(y.jsxs)(t,{children:[" Distance: ",(e.info.totaldistance/1e3).toFixed(3),"km "]}),Object(y.jsxs)(t,{children:[" Time: ",(e.info.totaltime/3600).toFixed(2),"h "]}),Object(y.jsxs)(t,{children:[" Ascent: ",(e.info.totalelevation/1e3).toFixed(3),"km "]})]})}function P(e){return Object(y.jsxs)("div",{children:[Object(y.jsx)(F,{label:"Elevation Graph",enabled:e.graphEnabled,setEnabled:e.setGraphEnabled}),Object(y.jsx)(F,{label:"Trip Summary",enabled:e.totalsEnabled,setEnabled:e.setTotalsEnabled}),Object(y.jsx)(F,{label:"Day Summary",enabled:e.hoverboxEnabled,setEnabled:e.setHoverboxEnabled})]})}function N(e){return Object(i.useEffect)((function(){var t=10,n=30,a=30,r=50,c=660-r-n,i=300-t-a;A.h("#chartsvg").remove();var s=A.h("#chartdiv").append("svg").attr("id","chartsvg").attr("width",c+r+n).attr("height",i+t+a).append("g").attr("transform","translate(".concat(r,",").concat(t,")")),o=function(){var t=Object(j.a)(b.a.mark((function t(n){var a,r,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=function(t){switch(e.value){case"Speed":return t.speed;case"Elevation":return t.elevation;default:return 0}},r=A.g().domain(A.d(e.graphData,(function(e){return 1e3*e.time}))).range([0,c]),s.append("g").attr("transform","translate(0,".concat(i,")")).call(A.b(r)),o=A.f().domain([0,A.e(e.graphData,(function(e){return a(e)}))]).range([i,0]),s.append("g").call(A.c(o)),s.append("path").datum(e.graphData).attr("fill","#cce5df").attr("stroke","#69b3a2").attr("stroke-width",1.5).attr("d",A.a().x((function(e){return r(1e3*e.time)})).y0(o(0)).y1((function(e){return o(a(e))})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();switch(e.value){case"Speed":o("speed");break;case"Elevation":o("elevation")}}),[e.graphData,e.value]),"None"===e.value?Object(y.jsx)("div",{}):Object(y.jsx)("div",{className:"card",id:"graphbox",style:{position:"absolute",right:"0px",top:"0px"},children:Object(y.jsx)("div",{id:"chartdiv"})})}function B(e){var t=Object(i.useState)(0),n=Object(h.a)(t,2),a=n[0],r=n[1];if(Object(i.useEffect)((function(){for(var t=function(t){var n,a=Q(t,e.info);null===(n=e.map)||void 0===n||n.on("mouseenter",a,(function(){var n;1===(null===(n=e.map)||void 0===n?void 0:n.getPaintProperty(a,"line-opacity"))&&r(t-1)}))},n=0;n<e.info.days.length;n++)t(n);console.log("Hover listeners setup: ",e.info.days.length,e.map)}),[e.map,e.loaded,e.info]),-1===a||e.info.distances.length<=a)return Object(y.jsx)("div",{});var c=v.a.p(D||(D=Object(f.a)(["\n    margin-bottom: 0px;\n    margin-top: 2px;\n  "])));return Object(y.jsxs)("div",{className:"card",id:"hoverbox",style:{position:"absolute",left:"0px",bottom:"0px"},children:[Object(y.jsxs)("h3",{children:[" Day ",a+1,": ",Q(a+1,e.info)," "]}),Object(y.jsxs)(c,{children:[" Distance: ",(e.info.distances[a]/1e3).toFixed(3),"km "]}),Object(y.jsxs)(c,{children:[" Time: ",(e.info.times[a]/3600).toFixed(2),"h "]}),Object(y.jsxs)(c,{children:[" Ascent: ",e.info.elevations[a].toFixed(0),"m "]}),Object(y.jsxs)(c,{children:[" Max Speed: ",(3.6*e.info.topspeeds[a]).toFixed(1),"km/h "]}),Object(y.jsxs)(c,{children:[" Average Speed: ",(3.6*e.info.averagespeeds[a]).toFixed(1),"km/h "]})]})}function H(e){var t=Object(i.useState)("All"),n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(i.useEffect)((function(){var t=function(t){for(var n=1;n<e.info.days.length;n++){var a;null===(a=e.map)||void 0===a||a.setPaintProperty(Q(n,e.info),"line-opacity",t.includes(n)?1:0)}},n=function(t){for(var n=[[0,0],[0,0],[0,0],[0,0],[0,0]],a=0;a<e.info.days.length;a++){var r=t[a];n[0][0]<r&&(n[0]=[r,a]),n.sort((function(e,t){return e[0]-t[0]}))}return n.map((function(e){return e[1]+1}))},r=function(t){var a=e.info[t];return n(a)},c=e.info.distances.map((function(t,n){return a=n,e.info.elevations[a]/(e.info.distances[a]/1e3);var a}));switch(a){case"All":t(Object(d.a)(Array(e.info.days.length+1).keys()));break;case"Top Distance":t(r("distances"));break;case"Top Elevation":t(r("elevations"));break;case"Top Time":t(r("times"));break;case"Top Hilliness":t(n(c));break;case"Top Average Speed":t(r("averagespeeds"));break;case"Top Max Speed":t(r("topspeeds"));break;default:t([])}}),[a,e.info,e.map]),Object(y.jsxs)(E,{value:a,setter:r,children:[Object(y.jsx)(C,{value:"All"}),Object(y.jsx)(C,{value:"Top Average Speed"}),Object(y.jsx)(C,{value:"Top Max Speed"}),Object(y.jsx)(C,{value:"Top Distance"}),Object(y.jsx)(C,{value:"Top Time"}),Object(y.jsx)(C,{value:"Top Elevation"}),Object(y.jsx)(C,{value:"Top Hilliness"})]})}function G(e){var t=Object(i.useState)("Same"),n=Object(h.a)(t,2),a=n[0],r=n[1];return Object(i.useEffect)((function(){var t=e.info,n=e.map,r=function(e){for(var a=1;a<t.days.length;a++){var r=Q(a,t),c="string"===typeof e?e:e(a);null===n||void 0===n||n.setPaintProperty(r,"line-color",c)}},c=t.elevations.map((function(e,n){return e/t.distances[n]})),i=Math.max.apply(Math,Object(d.a)(t.distances)),s=Math.min.apply(Math,Object(d.a)(t.distances)),o=Math.max.apply(Math,Object(d.a)(t.elevations)),l=Math.min.apply(Math,Object(d.a)(t.elevations)),u=Math.max.apply(Math,Object(d.a)(t.topspeeds)),p=Math.min.apply(Math,Object(d.a)(t.topspeeds)),b=Math.max.apply(Math,Object(d.a)(t.averagespeeds)),j=Math.min.apply(Math,Object(d.a)(t.averagespeeds)),f=Math.max.apply(Math,Object(d.a)(c)),h=Math.min.apply(Math,Object(d.a)(c));switch(a){case"Same":r("#fc4c02");break;case"Province":r((function(e){var n=t.days[e],a=t.provinces.findIndex((function(e){return e[1]>=n})),r=-1===a?0:a-1;return["#2196f3","#ff9800","#43a047","#81d4fa","#e53935","#1a237e","#00acc1","#004d40","#e65100","#4e342e"][["BC","Alberta","Saskatchewan","Manitoba","Ontario","Quebec","New Brunswick","Nova Scotia","PEI","Newfoundland"].indexOf(t.provinces[r][0])]}));break;case"Day":r((function(e){var t=["#2196f3","#ff9800","#43a047","#e53935"];return t[e%t.length]}));break;case"Elevation":r((function(e){return L("#FFFFFF","#000000",(t.elevations[e-1]-l)/(o-l))}));break;case"Hilliness":r((function(e){return L("#FFFFFF","#000000",function(e){return(c[e-1]-h)/(f-h)}(e))}));break;case"Distance":r((function(e){return L("#FFFFFF","#000000",(t.distances[e-1]-s)/(i-s))}));break;case"Top Speed":r((function(e){return L("#FFFFFF","#000000",(t.topspeeds[e-1]-p)/(u-p))}));break;case"Average Speed":r((function(e){return L("#FFFFFF","#000000",(t.averagespeeds[e-1]-j)/(b-j))}))}}),[a,e.info,e.map]),Object(y.jsxs)(E,{value:a,setter:r,children:[Object(y.jsx)(C,{value:"Same"}),Object(y.jsx)(C,{value:"Province"}),Object(y.jsx)(C,{value:"Day"}),Object(y.jsx)(C,{value:"Distance"}),Object(y.jsx)(C,{value:"Hilliness"}),Object(y.jsx)(C,{value:"Elevation"}),Object(y.jsx)(C,{value:"Top Speed"}),Object(y.jsx)(C,{value:"Average Speed"})]})}function L(e,t,n){var a=+e.replace(/#/g,"0x"),r=a>>16,c=a>>8&255,i=255&a,s=+t.replace(/#/g,"0x");return"#"+((1<<24)+(r+n*((s>>16)-r)<<16)+(c+n*((s>>8&255)-c)<<8)+(i+n*((255&s)-i))|0).toString(16).slice(1)}function J(){return _.apply(this,arguments)}function _(){return(_=Object(j.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/biketrip-viewer/bike_data/info",e.next=3,fetch("/biketrip-viewer/bike_data/info");case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,console.log(n),e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t){return Y.apply(this,arguments)}function Y(){return Y=Object(j.a)(b.a.mark((function e(t,n){var a,r,c,i,s,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){return(r=Object(j.a)(b.a.mark((function e(t){var n,a,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/biketrip-viewer/bike_data/"+t,e.next=3,fetch(n);case 3:return a=e.sent,e.next=6,a.blob();case 6:return r=e.sent,e.next=9,r.arrayBuffer();case 9:return c=e.sent,console.log("Finished Graph Data: "+t),e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)},a=function(e){return r.apply(this,arguments)},e.t0=Int32Array,e.next=5,a("time");case 5:return e.t1=e.sent,c=new e.t0(e.t1),e.t2=Float32Array,e.next=10,a("speed");case 10:return e.t3=e.sent,i=new e.t2(e.t3),e.t4=Float32Array,e.next=15,a("ele");case 15:e.t5=e.sent,s=new e.t4(e.t5),o=t.map((function(e,t){return{latitude:e[0],longtitude:e[1],time:c[t],speed:i[t],elevation:s[t]}})),console.log({locations:t,times:c,speeds:i,elevations:s}),console.log("Finished Setting Graph Data",o),n(o);case 21:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}function V(){return(V=Object(j.a)(b.a.mark((function e(t,n,a,r){var c,i,s,o,l,d,p,j,f,h,v,x,O;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:return c=e.sent,"/biketrip-viewer/bike_data/loc",i=[],e.next=7,fetch("/biketrip-viewer/bike_data/loc");case 7:return s=e.sent,e.next=10,s.blob();case 10:return o=e.sent,e.next=13,o.arrayBuffer();case 13:l=e.sent,d=new Float32Array(l),p=null,j=1,f=0,h=[],v=Object(u.a)(d);try{for(v.s();!(x=v.n()).done;)O=x.value,null===p?p=O:(i.push([O,p]),h.push([O,p]),f+=1,p=null),c.days[j]<=f&&(X(i,t,Q(j,c)),j+=1,i=[])}catch(b){v.e(b)}finally{v.f()}return n(c),console.log("Fetching complete"),e.next=25,z(h,a);case 25:r(!0);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e,t){return t.locations[e-1]+" to "+t.locations[e]}function X(e,t,n){t.addSource(n,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e}}}),t.addLayer({id:n,type:"line",source:n,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#fc4c02","line-width":5}})}O.a.workerClass=n(204).default,O.a.accessToken="pk.eyJ1Ijoic3VqYW5jaGFrcmFib3J0eSIsImEiOiJja2Q5MzBuc3owenplMnBzY2I0eDYwdDhvIn0.imItePLDlYNF2BGVde_mkw";var q=function(){var e=Object(i.useRef)(null),t=Object(i.useState)(),n=Object(h.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)({locations:[],provinces:[],days:[],distances:[],elevations:[],times:[],topspeeds:[],averagespeeds:[],totaltime:0,totalelevation:0,totaldistance:0}),s=Object(h.a)(c,2),o=s[0],l=s[1],u=Object(i.useState)([]),d=Object(h.a)(u,2),p=d[0],b=d[1],j=Object(i.useState)(!1),f=Object(h.a)(j,2),v=f[0],x=f[1];Object(i.useEffect)((function(){if("undefined"!==typeof window&&null!==e.current&&!a){var t=new O.a.Map({container:e.current,style:"mapbox://styles/mapbox/outdoors-v11",center:[-95,60],zoom:3});t.on("load",(function(){!function(e,t,n,a){V.apply(this,arguments)}(t,l,b,x)})),r(t)}}),[a]);var m=Object(i.useState)("Elevation"),g=Object(h.a)(m,2),F=g[0],w=(g[1],Object(i.useState)(!1)),E=Object(h.a)(w,2),C=E[0],T=E[1],D=Object(i.useState)(!1),A=Object(h.a)(D,2),L=A[0],J=A[1],_=Object(i.useState)(!1),z=Object(h.a)(_,2),Y=z[0],Q=z[1];return Object(y.jsxs)("div",{children:[Object(y.jsx)("div",{id:"background",children:Object(y.jsx)("div",{ref:e,className:"map-container"})}),Object(y.jsxs)(k,{show:L,children:[" ",Object(y.jsx)(N,{value:F,graphData:p})," "]}),Object(y.jsxs)(k,{show:Y,children:[" ",Object(y.jsx)(B,{info:o,map:a,loaded:v})," "]}),Object(y.jsxs)(k,{show:C,children:[" ",Object(y.jsx)(I,{info:o})," "]}),Object(y.jsxs)("div",{className:"card",id:"panel",children:[Object(y.jsx)("h1",{children:"Jacob\u2019s bike ride"}),Object(y.jsxs)("div",{style:{marginLeft:"10px"},children:[Object(y.jsx)(M,{title:"Line Color",children:Object(y.jsx)(G,{info:o,map:a})}),Object(y.jsx)(S,{}),Object(y.jsx)(M,{title:"Highlights",children:Object(y.jsx)(H,{info:o,map:a})}),Object(y.jsx)(S,{}),Object(y.jsx)(M,{title:"Options",children:Object(y.jsx)(P,{totalsEnabled:C,setTotalsEnabled:T,graphEnabled:L,setGraphEnabled:J,hoverboxEnabled:Y,setHoverboxEnabled:Q})})]})]})]})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,216)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};l.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(q,{})}),document.getElementById("root")),R()}},[[205,1,2]]]);
//# sourceMappingURL=main.7cdc70ae.chunk.js.map